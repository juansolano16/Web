var tablaMoto;var tbl_select;var cod_agencia;var vcolumns=[{"data":"cod_agencia"},{"data":"agencia"},{"data":"total_prod"},{"data":"registrados"},{"data":"porcentaje"},{"data":"sobrante"},{"data":"faltante"},{"data":"porcentaje"},];var vcolumnDefs=[{targets:[2,3,4,5,6],class:'text-center',},{targets:[-1],class:'text-center',orderable:false,render:function(data,type,row){var buttons='<a href="#" type="button" onclick="ingresarInvModal(this)" class="btn btn-warning btn-xs btn-flat" style="width:40px; margin-right: 10px;" ><i class="fas fa-edit"></i></a>';buttons+='<a href="#" type="button" onclick="generarReporte(this)" class="btn btn-success btn-xs btn-flat" style="width:40px;"><i class="fas fa-tasks"></i></a>';return buttons;}},];function recibeJsonInv(json){$('input[name="cod_comprobante"]').val(json['comprobante']);var tabla=tabs.find(element=>element.nom===select_tab);llenarTabla(id=tabla.id_tabla,list=json['data'],columns=vcolumns,columnDefs=vcolumnDefs)};function showDatosGrabadosInvModal(json){var vcolumns;if(select_tab===tabs[0].nom){vcolumns=[{"data":"cod_producto"},{"data":"serie"},{"data":"sobrante"},{"data":"faltante"},{"data":"estado_m"},{"data":"kit_m"},{"data":"observacion1"},{"data":"observacion2"},];}
else if(select_tab===tabs[1].nom){vcolumns=[{"data":"cod_producto"},{"data":"cantidad"},{"data":"cantidad_reg_r"},{"data":"sobrante"},{"data":"faltante"},{"data":"rayon_r"},{"data":"transferencia_r"},{"data":"observacion1"},{"data":"observacion2"},];}
else{vcolumns=[{"data":"cod_producto"},{"data":"serie"},{"data":"sobrante"},{"data":"faltante"},{"data":"desperfecto_a"},{"data":"promocional_a"},{"data":"garantia_a"},{"data":"porrecibir_a"},{"data":"observacion1"},{"data":"observacion2"},];};var vcolumnDefs=[{targets:[2,3,4],class:'text-center',},];var modaltab=select_tab===tabs[0].nom?'modal_tabla1':select_tab===tabs[1].nom?'modal_tabla2':'modal_tabla3';llenarTabla(id=modaltab,list=json['data'],columns=vcolumns,columnDefs=vcolumnDefs,modal='S')
$('.modal-dialog').removeClass().addClass('modal-dialog modal-xl');$('#'+modaltab+' tr td').css('height','40px')
if(select_tab===tabs[0].nom)$('#modalform1').modal('show');if(select_tab===tabs[1].nom)$('#modalform2').modal('show');if(select_tab===tabs[2].nom)$('#modalform3').modal('show');};function ingresarInvModal(element){$('input[name="action"]').val('grabarEstadoInv');modal_title.find('span').html('Resultado Inventario');modal_title.find('i').removeClass().addClass('fas fa-tasks');var tr=tbl_select.cell($(element).closest('td, li')).index();var data=tbl_select.row(tr.row).data();var url=window.location.pathname;var data_={'action':'searchResultadoGrabado','cod_agencia':data.cod_agencia,'categoria':select_tab}
sendDataAjax(url,data_,showDatosGrabadosInvModal);};function generarReporte(element){var tr=tbl_select.cell($(element).closest('td, li')).index();var data=tbl_select.row(tr.row).data();cod_agencia=data.cod_agencia;msjConfirmacion(title='Seguro de Generar Reporte?',text="En un momento se va generar el reporte.",text_ok='Si, Descargar!',callback=descargarRep);};function descargarRep(){$('input[name="action"]').val('genReporte')
var data_='action=generarReporte&cod_agencia='+cod_agencia;var nombreRep="Inventario"+cod_agencia+'.pdf'
genArchivo(window.location.pathname,data_,nombreRep);};;